{% extends "base.html" %}
{% block title %}Language Coach тАФ Home{% endblock %}
{% block body_class %}dashboard-page{% endblock %}

{% block content %}
<!-- Hero -->
<section class="hero-section">
  <div class="container">
    <div class="row align-items-center py-5">
      <div class="col-lg-7">
        <h1 class="hero-title">ржЖржкржирж╛ржХрзЗ рж╕рзНржмрж╛ржЧрждржо! <span class="wave">ЁЯСЛ</span></h1>
        <p class="hero-subtitle">Learn <strong>French</strong> &amp; <strong>Spanish</strong> through <strong>Bengali</strong> and <strong>English</strong></p>
        <p class="hero-desc text-muted">
          ржлрж░рж╛рж╕рж┐ ржУ рж╕рзНржкрзНржпрж╛ржирж┐рж╢ рж╢рж┐ржЦрзБржи ржмрж╛ржВрж▓рж╛ ржУ ржЗржВрж░рзЗржЬрж┐рж░ ржорж╛ржзрзНржпржорзЗ тАФ ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ, ржЗржирзНржЯрж╛рж░рзЗржХрзНржЯрж┐ржн ржкржжрзНржзрждрж┐рждрзЗред
        </p>
        {% if activity %}
        <div class="d-flex gap-2 flex-wrap mt-3">
          <span class="badge rounded-pill bg-light text-dark">
            ЁЯФе Streak: {{ activity.streak_days }} day{% if activity.streak_days != 1 %}s{% endif %}
          </span>
          <span class="badge rounded-pill bg-light text-dark">
            тнР XP Today: {{ activity.xp_today }}
          </span>
          <span class="badge rounded-pill bg-light text-dark">
            ЁЯГП Reviews Today: {{ activity.reviews_today }}
          </span>
        </div>
        {% endif %}
        <div class="d-flex gap-3 flex-wrap mt-4">
          <a href="/language/french" class="btn btn-french btn-lg">ЁЯЗлЁЯЗ╖ Start French</a>
          <a href="/language/spanish" class="btn btn-spanish btn-lg">ЁЯЗкЁЯЗ╕ Start Spanish</a>
        </div>
      </div>
      <div class="col-lg-5 d-none d-lg-flex justify-content-center">
        <div class="hero-flags">
          <div class="flag-card flag-card-fr">ЁЯЗлЁЯЗ╖<br><small>Fran├зais</small></div>
          <div class="flag-card flag-card-bd">ЁЯЗзЁЯЗй<br><small>ржмрж╛ржВрж▓рж╛</small></div>
          <div class="flag-card flag-card-es">ЁЯЗкЁЯЗ╕<br><small>Espa├▒ol</small></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Progress Cards -->
<section class="py-5 bg-light">
  <div class="container">
    <h2 class="section-title text-center mb-4">ржЖржкржирж╛рж░ ржЕржЧрзНрж░ржЧрждрж┐ тАФ Your Progress</h2>
    <div class="row g-4">
      {% for lang, s in stats.items() %}
      {% set meta = lang_meta[lang] %}
      <div class="col-md-6">
        <div class="progress-card card shadow-sm h-100">
          <div class="card-body p-4">
            <div class="d-flex align-items-center gap-3 mb-3">
              <span class="lang-flag">{{ meta.flag }}</span>
              <div>
                <h3 class="mb-0 fw-bold">{{ meta.name }}</h3>
                <small class="text-muted">{{ meta.name_bn }}</small>
              </div>
              <div class="ms-auto">
                <span class="badge bg-{{ 'french-badge' if lang == 'french' else 'spanish-badge' }} fs-6">
                  {{ s.completed }}/{{ s.total }}
                </span>
              </div>
            </div>
            <div class="progress mb-3" style="height:12px">
              <div class="progress-bar bg-{{ 'french' if lang == 'french' else 'spanish' }}"
                   style="width:{{ s.percent }}%">{{ s.percent }}%</div>
            </div>
            <p class="text-muted small mb-3">
              {{ s.completed }} lessons completed out of {{ s.total }} total
              <br>{{ s.completed }} ржЯрж┐ ржкрж╛ржа рж╕ржорзНржкржирзНржи, ржорзЛржЯ {{ s.total }} ржЯрж┐
            </p>
            {% if s.next_lesson %}
            <div class="small text-muted mb-3">
              Next: Lesson {{ s.next_lesson.id }} тАФ {{ s.next_lesson.title_en }}
            </div>
            {% endif %}

            {% if s.resource %}
            <div class="small text-muted mb-3">
              Personal corpus: {{ s.resource.sentence_count }} sentence{% if s.resource.sentence_count != 1 %}s{% endif %}{% if s.resource.coverage_pct %} тАв coverage {{ s.resource.coverage_pct }}%{% endif %}
              {% if s.resource.top_categories and s.resource.top_categories|length %}
              <br>Focus: {% for c in s.resource.top_categories %}{{ c.label }}{% if not loop.last %}, {% endif %}{% endfor %}
              {% endif %}
              {% if s.resource.focus_lesson %}
              <br>Suggested: <a href="{{ url_for('lesson_view', lang=lang, lesson_id=s.resource.focus_lesson.id) }}" class="text-decoration-none">Lesson {{ s.resource.focus_lesson.id }} тАФ {{ s.resource.focus_lesson.title_en }}</a>
              {% endif %}
            </div>
            {% endif %}
            <div class="d-grid gap-2">
              <a href="{{ s.continue_url }}" class="btn btn-{{ 'french' if lang == 'french' else 'spanish' }} w-100">
                {% if s.next_lesson %}тЦ╢ Continue Lesson {{ s.next_lesson.id }}{% else %}тЦ╢ View Lessons{% endif %}
              </a>
              <div class="d-flex gap-2">
                <a href="{{ url_for('practice', lang=lang) }}" class="btn btn-outline-{{ 'french' if lang == 'french' else 'spanish' }} btn-sm w-100">
                  тЪб Practice
                </a>
                <a href="{{ url_for('review_flashcards', lang=lang) }}" class="btn btn-outline-secondary btn-sm w-100">
                  ЁЯГП Review
                </a>
              </div>
              {% if s.resource %}
              <a href="{{ url_for('practice', lang=lang, mode='resources') }}" class="btn btn-outline-{{ 'french' if lang == 'french' else 'spanish' }} btn-sm w-100">
                ЁЯУЪ Resource Drill
              </a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Features -->
<section class="py-5">
  <div class="container">
    <h2 class="section-title text-center mb-5">ржХрзАржнрж╛ржмрзЗ рж╢рж┐ржЦржмрзЗржи тАФ How You Learn</h2>
    <div class="row g-4 text-center">
      <div class="col-md-3 col-6">
        <div class="feature-card p-3">
          <div class="feature-icon">ЁЯУЦ</div>
          <h5 class="mt-3">Vocabulary<br><small class="text-muted">рж╢ржмрзНржжржнрж╛ржирзНржбрж╛рж░</small></h5>
          <p class="small text-muted">Words with Bengali, English &amp; pronunciation</p>
        </div>
      </div>
      <div class="col-md-3 col-6">
        <div class="feature-card p-3">
          <div class="feature-icon">ЁЯГП</div>
          <h5 class="mt-3">Flashcards<br><small class="text-muted">ржлрзНрж▓рзНржпрж╛рж╢ржХрж╛рж░рзНржб</small></h5>
          <p class="small text-muted">Interactive flip cards for memorization</p>
        </div>
      </div>
      <div class="col-md-3 col-6">
        <div class="feature-card p-3">
          <div class="feature-icon">ЁЯза</div>
          <h5 class="mt-3">Quizzes<br><small class="text-muted">ржХрзБржЗржЬ</small></h5>
          <p class="small text-muted">Test yourself with multiple-choice questions</p>
        </div>
      </div>
      <div class="col-md-3 col-6">
        <div class="feature-card p-3">
          <div class="feature-icon">ЁЯУР</div>
          <h5 class="mt-3">Grammar<br><small class="text-muted">ржмрзНржпрж╛ржХрж░ржг</small></h5>
          <p class="small text-muted">Articles, tenses explained in Bengali</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CEFR Learning Path -->
<section class="py-5 bg-light">
  <div class="container">
    <h2 class="section-title text-center mb-2">CEFR рж╢рж┐ржХрзНрж╖рж╛рж░ ржкрже тАФ Learning Roadmap</h2>
    <p class="text-center text-muted mb-5 small">Aligned with DELF (French) &amp; DELE (Spanish) international exams</p>
    <div class="row g-3">
      {% set cefr_steps = [
        ('A1', 'cefr-A1', 'ЁЯЯв', 'Elementary', 'ржкрзНрж░рж╛ржержорж┐ржХ', 'Greetings ┬╖ Numbers ┬╖ Colors ┬╖ Family ┬╖ Body ┬╖ Food ┬╖ Nationalities ┬╖ Daily Routine ┬╖ Hobbies', 'DELF A1 / DELE A1', '16 lessons'),
        ('A2', 'cefr-A2', 'ЁЯФ╡', 'Pre-intermediate', 'ржкрзНрж░рж┐-ржЗржирзНржЯрж╛рж░ржорж┐ржбрж┐ржпрж╝рзЗржЯ', 'Past & Future Tenses ┬╖ Health ┬╖ Home ┬╖ Sports ┬╖ Work ┬╖ Shopping ┬╖ Emotions ┬╖ Travel', 'DELF A2 / DELE A2', '11 lessons'),
        ('B1', 'cefr-B1', 'ЁЯЯа', 'Intermediate', 'ржоржзрзНржпржмрж░рзНрждрзА', 'Complex vocabulary ┬╖ Advanced cuisine ┬╖ Cultural topics ┬╖ Fluent conversation', 'DELF B1 / DELE B1', '1 lesson'),
        ('B2', 'cefr-B2', 'ЁЯФ┤', 'Upper Intermediate', 'ржЙржкрж░рзЗрж░ ржоржзрзНржпржмрж░рзНрждрзА', 'Debate ┬╖ Professional contexts ┬╖ Nuanced expression ┬╖ Literature', 'DELF B2 / DELE B2', 'Coming soon')
      ] %}
      {% for lvl, badge_cls, icon, name, name_bn, topics, exam, count in cefr_steps %}
      <div class="col-md-6 col-lg-3">
        <div class="path-card p-4 text-center h-100">
          <div class="path-icon">{{ icon }}</div>
          <div class="mt-2 mb-1">
            <span class="badge {{ badge_cls }} fs-5 px-3 py-2">{{ lvl }}</span>
          </div>
          <h5 class="mt-2 mb-0">{{ name }}</h5>
          <small class="text-muted d-block mb-2">{{ name_bn }}</small>
          <p class="small text-muted mt-2 mb-2">{{ topics }}</p>
          <div class="mt-auto pt-2">
            <span class="badge bg-light text-dark border small d-block mb-1">{{ exam }}</span>
            <span class="badge bg-secondary-subtle text-secondary small">{{ count }}</span>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}
